# チケット#06: 当たり判定システム実装

## 📋 概要
ゲーム内の全ての当たり判定を管理するシステムを実装する。
プレイヤー弾と敵、敵弾とプレイヤー、プレイヤーと敵機体の衝突を検出し、適切な処理を行う。

## 🎯 完了条件
- プレイヤー弾が敵に当たると敵がダメージを受ける
- 敵弾がプレイヤーに当たるとライフが減る
- 敵機体とプレイヤーが接触するとダメージを受ける
- 衝突時にエフェクトが表示される
- パフォーマンスが最適化されている

## 📦 依存関係
- チケット#02（プレイヤーシステム）が完了していること
- チケット#03（ショットシステム）が完了していること
- チケット#04（基本敵キャラクター）が完了していること
- チケット#05（敵キャラクター拡張）が完了していること

## ✅ コミット粒度のToDo

### 1. CollisionManagerクラスの実装
- [x] `js/collisionManager.js` を作成
- [x] CollisionManager クラスの定義
- [x] 衝突チェックのメインループ
- [x] 衝突タイプの定義

**コミットメッセージ例**: `feat: CollisionManagerクラスの基本構造を実装`

### 2. 円形当たり判定の実装
- [x] 円と円の衝突判定アルゴリズム
- [x] 距離計算の最適化（平方根を避ける）
- [x] 判定領域のデバッグ表示機能
- [x] 衝突座標の取得

**コミットメッセージ例**: `feat: 円形当たり判定アルゴリズムを実装`

### 3. プレイヤー弾と敵の衝突
- [x] 弾と敵の衝突チェック
- [x] 敵へのダメージ処理
- [x] 弾の消去処理
- [x] 敵撃破時の処理呼び出し

**コミットメッセージ例**: `feat: プレイヤー弾と敵の衝突処理を実装`

### 4. 敵弾とプレイヤーの衝突
- [x] 敵弾とプレイヤーの衝突チェック
- [x] プレイヤーへのダメージ処理
- [x] 敵弾の消去処理
- [x] 無敵時間中のスキップ処理

**コミットメッセージ例**: `feat: 敵弾とプレイヤーの衝突処理を実装`

### 5. プレイヤーと敵機体の衝突
- [x] 機体同士の衝突チェック
- [x] 接触ダメージの処理
- [x] 小型機は即座に破壊
- [x] 中型・大型機はダメージのみ

**コミットメッセージ例**: `feat: プレイヤーと敵機体の衝突処理を実装`

### 6. 衝突エフェクトの実装
- [x] `js/effects.js` を作成
- [x] 爆発エフェクトの実装
- [x] ダメージエフェクトの実装
- [x] パーティクルシステムの基礎

**コミットメッセージ例**: `feat: 衝突時のビジュアルエフェクトを実装`

### 7. パフォーマンス最適化
- [x] 空間分割による判定数削減
- [x] 画面外オブジェクトのスキップ
- [x] 早期リターンの実装
- [x] 処理順序の最適化

**コミットメッセージ例**: `perf: 当たり判定のパフォーマンスを最適化`

### 8. ゲームへの統合とバランス調整
- [x] game.js への統合
- [x] 当たり判定サイズの調整
- [x] ダメージ値の調整
- [x] デバッグモードの追加

**コミットメッセージ例**: `feat: 当たり判定システムをゲームに統合`

## 🧪 テスト観点
- [ ] プレイヤー弾が敵に当たると敵が消えること
- [ ] 敵弾がプレイヤーに当たるとライフが減ること
- [ ] 無敵時間中は敵弾が当たらないこと
- [ ] 敵機体に接触するとダメージを受けること
- [ ] 衝突時にエフェクトが表示されること
- [ ] 多数のオブジェクトでも処理が重くならないこと

## 📝 レビューポイント
- 当たり判定の精度が適切か
- パフォーマンスが十分か
- 判定領域のサイズバランスが適切か
- コードの可読性と保守性

## 🚀 次のチケットへの準備
このチケットが完了すると、経験値とレベルアップシステム（チケット#07）で敵撃破時の報酬を実装できます。